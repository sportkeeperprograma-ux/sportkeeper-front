(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[428],{373:(e,t,r)=>{"use strict";var a;r.d(t,{H:()=>n});let n=(null==(a=r(5704).env.NEXT_PUBLIC_API_URL)?void 0:a.trim())||"https://sportkeeper.onrender.com"},667:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(5155),n=r(2821);function o(e){let{className:t,children:r,variant:o="primary",loading:s,disabled:i,...l}=e;return(0,a.jsxs)("button",{className:(0,n.A)("inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-medium transition",{primary:"bg-black text-white hover:opacity-90",secondary:"bg-gray-200 hover:bg-gray-300",danger:"bg-red-600 text-white hover:bg-red-700",ghost:"hover:bg-gray-100"}[o],i||s?"opacity-50 cursor-not-allowed":"",t),disabled:i||s,...l,children:[s&&(0,a.jsx)("span",{className:"mr-2 inline-block size-4 animate-spin border-2 border-gray-300 border-r-transparent rounded-full"}),r]})}},1313:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,AuthProvider:()=>i});var a=r(5155),n=r(2115),o=r(373);let s=(0,n.createContext)({token:null,user:null,login:async()=>{},logout:()=>{},register:async()=>{}});function i(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[l,c]=(0,n.useState)(null);async function u(e){let t=await fetch("".concat(o.H,"/api/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("No se pudo cargar el perfil");return t.json()}(0,n.useEffect)(()=>{let e=localStorage.getItem("token");i(e),e&&u(e).then(c).catch(()=>{})},[]);let d=async(e,t)=>{let r=await fetch("".concat(o.H,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok)throw Error("Credenciales inv\xe1lidas");let{token:a}=await r.json();localStorage.setItem("token",a),i(a),c(await u(a))},h=async(e,t)=>{if(!(await fetch("".concat(o.H,"/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})).ok)throw Error("No se pudo registrar");await d(e,t)};return(0,a.jsx)(s.Provider,{value:{token:r,user:l,login:d,logout:()=>{localStorage.removeItem("token"),i(null),c(null)},register:h},children:t})}let l=()=>(0,n.useContext)(s)},2821:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=function(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,a,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var o=t.length;for(r=0;r<o;r++)t[r]&&(a=e(t[r]))&&(n&&(n+=" "),n+=a)}else for(a in t)t[a]&&(n&&(n+=" "),n+=a);return n}(e))&&(a&&(a+=" "),a+=t);return a}},3755:(e,t,r)=>{Promise.resolve().then(r.bind(r,7783))},7e3:(e,t,r)=>{"use strict";function a(e,t){let r=new Date(e),a=new Date(t);return"".concat(r.toLocaleDateString()," ").concat(r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," â†’ ").concat(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}r.d(t,{F:()=>a})},7621:(e,t,r)=>{"use strict";r.d(t,{$P:()=>s,Al:()=>l,Vg:()=>o,mu:()=>i});var a=r(373);async function n(e){try{return(await e.json()).message||e.statusText}catch(t){return e.statusText}}async function o(e){let t=localStorage.getItem("token"),r=await fetch("".concat(a.H).concat(e),{headers:t?{Authorization:"Bearer "+t}:void 0});if(!r.ok)throw Error(await n(r));return r.json()}async function s(e,t){let r=localStorage.getItem("token"),o=await fetch("".concat(a.H).concat(e),{method:"POST",headers:{"Content-Type":"application/json",...r?{Authorization:"Bearer "+r}:{}},body:JSON.stringify(t)});if(!o.ok)throw Error(await n(o));return o.json()}async function i(e,t){let r=localStorage.getItem("token"),o=await fetch("".concat(a.H).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...r?{Authorization:"Bearer "+r}:{}},body:JSON.stringify(t)});if(!o.ok)throw Error(await n(o));return o.json()}async function l(e){let t=localStorage.getItem("token"),r=await fetch("".concat(a.H).concat(e),{method:"DELETE",headers:t?{Authorization:"Bearer "+t}:void 0});if(!r.ok)throw Error(await n(r))}},7783:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(5155),n=r(2115),o=r(7621),s=r(667),i=r(8297),l=r(2821);function c(e){let{children:t,color:r="gray"}=e;return(0,a.jsx)("span",{className:(0,l.A)("inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium",{gray:"bg-gray-100 text-gray-700",green:"bg-green-100 text-green-700",red:"bg-red-100 text-red-700",blue:"bg-blue-100 text-blue-700"}[r]),children:t})}var u=r(7e3),d=r(1313);function h(){let[e,t]=(0,n.useState)([]),[r,l]=(0,n.useState)(""),[h,g]=(0,n.useState)(null),{user:m}=(0,d.A)(),f=async()=>{try{let e=await (0,o.Vg)("/api/slots");t(e)}catch(e){l(e.message||"Error cargando slots")}};(0,n.useEffect)(()=>{f()},[]);let y=async e=>{try{g(e),await (0,o.$P)("/api/reservations",{timeSlotId:e,email:null==m?void 0:m.email}),l("\xa1Reserva creada!"),await f()}catch(e){l(e.message||"No se pudo reservar")}finally{g(null)}};return(0,a.jsxs)("main",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Clases disponibles"}),r&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:r}),(0,a.jsx)("div",{className:"space-y-2",children:e.map(e=>{var t,r,n;let o=(null!=(t=e.reservedCount)?t:0)>=e.capacity;return(0,a.jsxs)(i.Zp,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.ZB,{children:[e.name," ",(r=e.startAt,n=e.endAt,(0,u.F)(r,n))]}),(0,a.jsxs)(i.Wu,{className:"mt-1",children:[e.description,(0,a.jsx)("br",{}),(0,a.jsxs)(c,{color:o?"red":"green",children:[e.reservedCount,"/",e.capacity," ",o?"Completo":"Plazas"]})]})]}),(0,a.jsx)(s.A,{onClick:()=>y(e.id),disabled:o,loading:h===e.id,children:o?"Completo":"Apuntarme"})]},e.id)})}),0===e.length&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No hay clases disponibles."})]})}},8297:(e,t,r)=>{"use strict";r.d(t,{Wu:()=>l,ZB:()=>i,Zp:()=>o,aR:()=>s});var a=r(5155),n=r(2821);function o(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.A)("rounded-2xl bg-white shadow p-4",t),...r})}function s(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.A)("mb-2 flex items-center justify-between",t),...r})}function i(e){let{className:t,...r}=e;return(0,a.jsx)("h3",{className:(0,n.A)("text-base font-semibold",t),...r})}function l(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.A)("text-sm text-gray-700",t),...r})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=3755)),_N_E=e.O()}]);